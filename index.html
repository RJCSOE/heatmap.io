<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>  Food System Status in 2050</title>
  <script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-core.min.js"></script>
  <script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-heatmap.min.js"></script>
  <script src="JS/chart.js"></script>
  <link rel="stylesheet" href="CSS/styles.css">

  <style type="text/css">      
    html, body, #container { 
      width: 100%; margin: 0; padding: 0; 
      height: 70%;
    } 

    /* Style for the heatmap container */
    #container {
      position: relative;
      width: 100%;
      height: 1500px; /* Adjust this for your desired height */
      overflow: auto; /* Makes it scrollable */
    }

    .anychart-heatmap {
      width: 800%; /* Ensure the chart expands to fill container */
    }

    /* Additional styling for the header */
    header {
      text-align: center;
      margin-bottom: 40px;
    }

    header img {
      max-width: 100px;
      margin-bottom: 10px;
    }

    header h1 {
      font-size: 24px;
    }

    /* Tooltip Styling: Double the size */
    .anychart-tooltip {
      font-size: 48px; /* Increase font size */
      width: 300px; /* Make the tooltip wider */
      height: 200px; /* Increase height */
      padding: 15px; /* More padding for better visibility */
    }
  </style>
</head>

<body>

  <header>
    <img src="IMAGES/Fosta_Icon_Rev.png" alt="fosta logo" />
    <h1>Food System Status in 2050</h1>
    <div class="clearAll"></div>
  </header>

  <div id="container">

    <script>
      anychart.onDocumentReady(function () {


// Disable auto-scaling on the x-axis
chart.xScale().mode('continuous');
chart.xScale().ticks().interval(1); // Ensure equal spacing

// Adjust column width
const columnWidth = 20; // Set this based on the smallest column
chart.xAxis().labels().fontSize(30);
chart.yAxis().labels().padding([3, 10, 3, 0]);
chart.xAxis().labels().padding([0, 0, 0, 10]);

// Set fixed width for the heatmap itself to prevent stretching
chart.bounds(0, 0, columnWidth * 4, 1500);
        
        // create a heatmap
        let chart = anychart.heatMap(getData());
        
        // set the container for the heatmap
        chart.container("container");

        // Disable auto-scaling on the x-axis (columns)
        chart.xScale().mode('continuous');  // Ensures the scale is continuous but no auto-resizing
        chart.xScale().ticks(true);
        
        // set fixed width for columns
        const columnWidth = 20;  // Adjust this for the fixed width
        chart.xAxis().labels().fontSize(30); // Adjust font size for the x-axis labels

        // draw the heatmap
        chart.draw();

        // enable legend
        chart.legend(true);
        chart.legend().useHtml(true);
        chart.legend().align("centre");
        chart.legend().fontWeight(300);

        // changes color scale
        chart.colorScale(colorScale);

        // enable html for the labels 
        chart.labels(false);

        // configure the labels
        chart.labels().format(function () {
          var heat = (this.heat);
          if (heat < 10) return "Improvement high confidence";
          if (heat < 20) return "Improvement low confidence";
          if (heat < 30) return "Unknown";
          if (heat < 40) return "Deterioration low confidence";
          if (heat > 40) return "Deterioration high confidence";
        });

        // styling the chart
        chart.xAxis().stroke(null);
        chart.yAxis().stroke(null);
        chart.yAxis().labels().padding([3, 10, 3, 0]);
        chart.xAxis().labels().padding([0, 0, 0, 10]);
        //chart.xAxis().labels().rotation(-90);

        // Adjust the size of the columns (set the width directly)
        chart.xAxis().ticks().interval(columnWidth); // Control column width

        // set the tooltip
        chart.tooltip().title().useHtml(true);
        var categoryNames = ["Unkown", "Improvement low confidence", "Improvement high confidence", "Deterioration low confidence", "Deterioration high confidence"];
        
        var tooltip = chart.tooltip();
        tooltip.fontWeight(400);
        tooltip.useHtml(true);
        tooltip.padding([10, 10, 10, 10]);
        tooltip.positionMode("point");        
        tooltip.format(function () {
          if (this.heat <= 10) {
            return (
              '<span class="tooltipText">RTP: </span>' + this.y + "<br/>" + '<span class="tooltipText"> Category: </span>' + categoryNames[0] + "<br/>" + '<span class="tooltipText">Implication Statement: </span>' + this.getData("custom_field"));
          }
          if (this.heat >= 11 && this.heat <= 20) {
            return ('<span class="tooltipText">RTP: </span>' + this.y + "<br/>" + '<span class="tooltipText"> Category: </span>' + categoryNames[1]);
          }
          if (this.heat >= 21 && this.heat <= 30) {
            return ('<span class="tooltipText">RTP: </span>' + this.y + "<br/>" + '<span class="tooltipText"> Category: </span>' + categoryNames[2]);
          }
          if (this.heat >= 31 && this.heat <= 40) {
            return ('<span class="tooltipText">RTP: </span>' + this.y + "<br/>" + '<span class="tooltipText"> Category: </span>' + categoryNames[2]);
          }
          if (this.heat >= 41) {
            return ('<span class="tooltipText">RTP: </span>' + this.y + "<br/>" + '<span class="tooltipText"> Category: </span>' + categoryNames[2]);
          }
        });
      });
    </script>
  </div>
</body>
</html>
